{% extends "base.html" %}

{% block title %}
  Status
{% endblock %}

{% block body %}

{% for pos in positions %}

  <div class="device_box">
    <div id="{{pos}}" class="preview_element"></div>
    <iframe class="preview_element" src="{{url_analysis[pos]}}" title="{{pos}}"></iframe>
  </div>

  <script>
    $(document).ready(function() {
      var refreshPage = function() {
        for (pos of {{positions}}) {
          refreshDeviceStatus(pos);
        }
        setTimeout(refreshPage, 3000);
      };
      refreshPage();
    })
  </script>


  <script>
    /*Refresh the device status every 2 seconds.*/
    function refreshDeviceStatus(deviceId) {
      $.ajax({
        url: "{{url_device["none"]}}",
        type: "GET",
        contentType: "application/json;charset=UTF-8",
        data: {
          "device_id": deviceId,
        },
        dataType:"html",
        success: function (data) {
          $("#" + deviceId).html(data);
        }
      });
    }
  </script>
{% endfor %}

{% endblock %}
